
- netexec: 
	- `netexec ldap megacorpone.com -u username -p password -M adcs`
- ldapsearch: 
	- `ldapsearch -H ldap://dc_IP -x -LLL -D 'CN=<user>,OU=Users,DC=domain,DC=local' -w '<password>' -b "CN=Enrollment Services,CN=Public Key Services,CN=Services,CN=CONFIGURATION,DC=domain,DC=local" dNSHostName`
- certipy: 
	 - certipy-ad find -u 'afsimmons@megacorpone.com' -p 'password' -dc-ip dc_ip -vulnerable -enabled
	 - certipy-ad find -u 'afsimmons@megacorpone.com' -p 'password' -dc-ip 'dc_ip' -old-bloodhound
	 - certipy-ad find -u 'afsimmons@megacorpone.com' -p 'password' -dc-ip 'dc_ip' -bloodhound
	 
- certutil: 
	- `certutil.exe -config - -ping`, `certutil -dump
- certi:
	- Source: https://github.com/zer1t0/certi
	- python certi.py list 'megacorpone.com/afsimmons' -k -n --dc-ip 172.21.0.0 --vuln --enable | grep "CERTIFICATE" -B 3
	- python certi.py list 'megacorpone.com/afsimmons' -k -n --dc-ip 172.21.0.0 --class ca
- BloodyAD
	- python bloodyAD.py -u afsimmons -p 'Spawn123!' --host 172.21.1.1 -d megacorpone.com get search --base 'CN=Configuration,DC=megacorpone,DC=local' --filter '(&(objectclass=pkicertificatetemplate)(!(mspki-enrollment-flag:1.2.840.113556.1.4.804:=2))(|(mspki-ra-signature=0)(!(mspki-ra-signature=*)))(|(pkiextendedkeyusage=2.5.29.37.0)(!(pkiextendedkeyusage=*))))'




## References: 

- https://github.com/ly4k/Certipy
- https://posts.specterops.io/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb
- https://www.netexec.wiki/ldap-protocol/exploit-esc8-adcs
- https://github.com/CravateRouge/bloodyAD?tab=readme-ov-file

