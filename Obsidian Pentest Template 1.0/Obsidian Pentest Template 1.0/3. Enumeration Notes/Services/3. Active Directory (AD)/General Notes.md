#enumeration #service-enumeration
# Note: Be cautious when brute forcing Active Directory, as it can trigger the Account Lockout Policy and disable user accounts.


## Anonymous Credential LDAP Dumping: 

- ldapsearch -LLL -x -H ldap://"domain fqdn" -b ‘’ -s base ‘(objectclass=*)’

Impacket GetADUsers.py (Must have valid credentials)

- GetADUsers.py -all domain\User -dc-ip 172.21.0.0

Impacket lookupsid.py:

- /usr/share/doc/python3-impacket/examples/lookupsid.py username:password@172.21.0.0

Impacket Secretdump:

python3 secretdump.py 'breakme.local/Administrator@172.21.0.0' -just-dc-user anakin

Windapsearch:

https://github.com/ropnop/windapsearch 

- python3 windapsearch.py -d host.domain -u domain\\ldapbind -p PASSWORD -U

## Netexec:

- netexec ldap "ip-address" -u "" -p "" -d "domain"

- netexec ldap "ip address" -u "Guest" -p "" -d "domain"

## Enumerating for users through kerberos

- sudo nmap --script=krb5-enum-users --script-args="krb5-enum-users.realm='megacorpone.com',users.txt" 172.21.0.0

## References: 

- PayloadAllTheThings:
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#most-common-paths-to-ad-compromise

- Attacking Active Directory: 0 to 0.9:
https://zer1t0.gitlab.io/posts/attacking_ad/